<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto t1nzx; NGSD1: Ia9i3: goto NXg11; t1nzx: if ($this->table) { goto Ia9i3; } goto O6Vs3; NXg11: parent::__construct(); goto skAZH; O6Vs3: $this->table = "\x69\164\145\155"; goto NGSD1; skAZH: } protected function postPage($request_data) { goto Lcxch; xJxJv: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto G7pGo; tMP14: goto gq2OB; goto GWWV7; MPgkL: $page = $page ? $page - 1 : 0; goto q64Kd; GWWV7: xBS6E: goto GPSqr; m0Asm: $perpage = $request_data["\x70\145\162\x70\x61\x67\145"] ?: 0; goto SXXCs; q64Kd: $total = $this->db->select($this->table)->where($where)->count(); goto xJxJv; smcxQ: $column = $request_data["\143\x6f\x6c\x75\x6d\x6e"] ?: "\52"; goto EjUSg; SXXCs: if ($perpage > 0) { goto xBS6E; } goto ii0Mc; EjUSg: $where = $request_data["\x77\150\145\x72\x65"] ?: "\x31\40\75\x20\61"; goto NgXa_; gYTsz: return $this->success($data); goto hwjPL; a4ghm: gq2OB: goto cyISH; ii0Mc: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto tMP14; Lcxch: $this->_callback("\x63\x61\x6c\x6c\x62\141\143\153\120\x61\147\145\x42\145\146\157\x72\x65", array(&$request_data)); goto smcxQ; G7pGo: $data = array("\x6c\151\x73\164" => $list, "\x74\157\x74\141\154" => $total, "\160\145\x72\160\141\147\x65" => $perpage, "\160\141\147\x65" => $page); goto a4ghm; GPSqr: $page = $request_data["\160\141\147\145"] ?: 1; goto MPgkL; NgXa_: $order = $request_data["\x6f\x72\144\145\162"] ?: $this->order; goto m0Asm; cyISH: $this->_callback("\143\x61\154\154\142\x61\x63\153\x50\141\147\x65\101\146\164\x65\162", array(&$data)); goto gYTsz; hwjPL: } protected function postQuery($request_data) { goto F1zLw; xJpQt: zbCvp: goto Ax1db; I9JJm: $sql = str_replace("\x24\x74\x61\x62\x6c\x65", $this->prefix . $this->table, $sql); goto xJpQt; Ax1db: return $this->db->query($sql, $request_data["\166\141\x6c\165\x65\163"])->all(); goto ZLMCG; Segnl: if (!(stripos($sql, "\44\164\141\x62\154\x65") !== false)) { goto zbCvp; } goto I9JJm; F1zLw: $sql = $request_data["\x73\x71\x6c"]; goto Segnl; ZLMCG: } protected function getOne($id, $column = null) { goto y79bq; y79bq: $column = $column ?: "\x2a"; goto kffn3; kffn3: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\75", $id))->get(); goto AIB2V; AIB2V: return $this->success($data); goto fZZp9; fZZp9: } protected function postAdd($request_data) { goto TMYAO; R41Kg: return $this->error("\xe6\xb7\xbb\345\212\xa0\346\225\xb0\xe6\215\xae\345\244\261\xe8\264\xa5\xef\xbc\x81"); goto AH6OZ; Ho3d3: $upload_name = $request_data["\x24\165\160\x6c\157\141\144\137\x6e\x61\155\x65"]; goto f6TIs; pN6nD: if ($id) { goto UE_AG; } goto FpQN9; XOkkS: $data = $this->_bulidData($request_data); goto kzqJw; ap_wB: return $this->success("\346\xb7\xbb\xe5\212\240\xe6\x95\260\xe6\215\256\346\210\x90\xe5\212\x9f\357\xbc\201", array("\x69\x64" => $id, "\x69\x6d\x61\147\x65\137\160\141\x74\x68" => $upload_path)); goto Smcq_; h2RVi: $udata[$upload_name] = $upload_path; goto FCR8p; kzqJw: $data["\x63\164\x69\155\145"] = time(); goto c545r; eZBCV: $udata["\x6c\x65\166\145\x6c"] = $this->_getLevel($pid, $id); goto bk9Ge; FpQN9: return $this->error("\346\xb7\273\345\x8a\xa0\346\225\xb0\xe6\x8d\xae\345\244\261\xe8\264\245\357\274\201"); goto rYfdE; YWhg1: if (!($upload_name && $upload_path)) { goto Qu1LA; } goto bSkXZ; Smcq_: cvA2I: goto SYjTo; ifeBo: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto h2RVi; S1sNL: $this->db->commit(); goto ap_wB; c545r: $this->db->beginTransaction(); goto Rlb5D; TMYAO: $this->_callback("\x63\141\x6c\x6c\142\141\143\x6b\101\144\x64\x42\x65\x66\157\162\145", array(&$request_data)); goto F1zIe; f6TIs: $upload_path = $request_data["\x24\165\160\154\x6f\x61\144\137\x70\141\164\150"]; goto YWhg1; Rlb5D: $id = $this->db->insert($this->table, $data)->id(); goto pN6nD; QtUbz: if ($this->db->update($this->table, $udata, array("\151\x64", "\x3d", $id))->is()) { goto aoC_n; } goto If734; AH6OZ: goto cvA2I; goto GtnA7; qBqAL: if (!($pid > 0 && in_array("\154\x65\x76\145\x6c", $this->fields))) { goto awLTD; } goto eZBCV; GtnA7: aoC_n: goto VtI_0; FCR8p: Qu1LA: goto QtUbz; bSkXZ: $data["\151\144"] = $id; goto ifeBo; bk9Ge: awLTD: goto Ho3d3; VtI_0: $this->_callback("\143\141\154\x6c\142\x61\143\153\101\x64\144\101\x66\164\x65\x72", array($id, &$request_data)); goto FaqjK; FaqjK: $this->_log("\x61\x64\x64", array("\x74\x69\164\154\x65" => $data["\x74\151\x74\x6c\145"], "\x74\141\x62\x6c\x65\x5f\151\x64" => $id)); goto S1sNL; F1zIe: $this->_removeFiles2($request_data["\x5f\162\145\155\x6f\x76\145\x66\151\154\145\163"]); goto XOkkS; If734: $this->db->rollBack(); goto R41Kg; kbY2n: $pid = $data["\160\x69\144"]; goto qBqAL; rYfdE: UE_AG: goto TZIsY; TZIsY: $udata = array("\x69\x64" => $id); goto kbY2n; SYjTo: } protected function postUpdate($id, $request_data) { goto DX02a; DX02a: $this->_callback("\x63\141\154\x6c\142\141\143\x6b\125\160\x64\x61\x74\145\x42\145\x66\x6f\162\x65", array(&$request_data)); goto CrSgm; F5rpg: Opsgf: goto R4ZFL; HyYLg: $data["\x75\x74\x69\155\145"] = time(); goto l8pF1; ZyPvQ: return $this->error("\344\xbf\x9d\345\xad\230\345\244\261\xe8\264\245\357\274\201"); goto VXH1s; R4ZFL: $upload_name = $request_data["\x24\x75\160\x6c\x6f\x61\x64\x5f\x6e\x61\x6d\145"]; goto IVQ60; Lea5b: $this->_log("\x75\x70\144\141\164\145", array("\x74\x69\x74\154\x65" => $data["\x74\x69\164\x6c\145"])); goto Wypoj; zzLxX: if ($this->db->update($this->table, $data, array("\x69\144", "\75", $id))->is()) { goto ab7fJ; } goto ZyPvQ; JUAIz: if (!($pid > 0 && in_array("\x6c\x65\x76\145\154", $this->fields))) { goto Opsgf; } goto adsEg; Wypoj: return $this->success("\xe5\267\xb2\xe4\xbf\235\345\255\230\xe6\233\xb4\346\224\271\xef\274\x81"); goto UrqfD; UrqfD: PP2M2: goto n7qPf; CrSgm: $this->_removeFiles2($request_data["\137\162\x65\155\x6f\166\145\x66\x69\x6c\145\x73"]); goto EJ__q; eJCSh: Jyi0V: goto qnMLh; adsEg: $data["\154\145\166\145\154"] = $this->_getLevel($pid, $id); goto F5rpg; qnMLh: XObJc: goto zzLxX; MsMz8: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto zSc9N; zSc9N: if (!in_array($upload_name, $this->fields)) { goto Jyi0V; } goto hH38r; IVQ60: $upload_path = $request_data["\x24\x75\160\154\157\141\x64\137\x70\x61\x74\x68"]; goto rHtr3; VXH1s: goto PP2M2; goto cmX99; EJ__q: $data = $this->_bulidData($request_data); goto HyYLg; cmX99: ab7fJ: goto Q7U2t; rHtr3: if (!($upload_name && $upload_path)) { goto XObJc; } goto MsMz8; hH38r: $data[$upload_name] = $upload_path; goto eJCSh; l8pF1: $pid = $data["\160\151\144"]; goto JUAIz; Q7U2t: $this->_callback("\143\x61\154\154\x62\x61\x63\153\x55\x70\144\141\164\145\101\146\x74\145\x72", array($id, &$request_data)); goto Lea5b; n7qPf: } protected function postField($request_data) { goto v4Z7i; kgD3V: $value = $request_data["\x76\141\154\x75\x65"]; goto ktW2r; ehgkY: return $this->success(); goto XwVrP; v4Z7i: $ids = $request_data["\x69\x64"]; goto F0veF; z9N2u: uOHre: goto ehgkY; IsMYR: goto CIMGQ; goto z9N2u; ktW2r: if ($this->db->update($this->table, array($name => $value), array("\x69\x64", "\x49\116", $ids))->is()) { goto uOHre; } goto Ysyj0; Ysyj0: return $this->error(); goto IsMYR; F0veF: $name = $request_data["\156\x61\155\145"]; goto kgD3V; XwVrP: CIMGQ: goto rSg_e; rSg_e: } protected function postCount($request_data) { goto weLy6; G2dvD: $where = $request_data["\x77\150\x65\x72\x65"] ?: "\61\40\75\40\61"; goto J7TEd; J7TEd: return $this->db->select($table)->where($where)->count(); goto e6yG9; weLy6: $table = $request_data["\x74\141\142\154\145"] ?: $this->table; goto G2dvD; e6yG9: } protected function postDelete($request_data) { goto docyu; nM85G: DmZ2l: goto MdxaP; KsQdy: $this->db->beginTransaction(); goto rgPyd; juxgg: QWByE: goto NqGcF; NqGcF: $this->_callback("\x63\141\154\154\x62\141\x63\x6b\104\145\x6c\145\x74\x65\101\x66\164\145\x72", array(&$request_data)); goto nEBgS; BzyQR: return $this->success(); goto xJ2Ng; OmR6l: return $this->error("\346\x9c\x89\40" . count($error) . "\xe6\x9d\xa1\xe6\x95\xb0\xe6\x8d\xae\345\210\xa0\351\231\xa4\345\244\xb1\xe8\xb4\xa5\xef\274\201"); goto Krnh7; itMF1: $this->_log("\x72\145\x6d\157\x76\x65", array("\x74\x69\164\x6c\x65" => count($ids))); goto BzyQR; Krnh7: goto eyIXm; goto juxgg; UGFIE: $error = array(); goto y_h5n; rgPyd: foreach ($ids as $id) { goto pXH1A; mHff8: goto daj3E; goto aOPxE; aOPxE: l2loC: goto e5qGZ; e5qGZ: $this->_trash($item, $request_data); goto QNpy9; PdGAu: TBKTA: goto ESqcj; UoUL3: if ($this->db->delete($this->table, array("\x69\x64", "\x3d", $id))->is()) { goto l2loC; } goto ePBDv; pXH1A: $item = $this->db->select($this->table)->where(array("\x69\x64", "\75", $id))->get(); goto UoUL3; R6zZS: goto TBKTA; goto mHff8; QNpy9: daj3E: goto PdGAu; ePBDv: $error[] = $id; goto R6zZS; ESqcj: } goto nM85G; nEBgS: $this->db->commit(); goto itMF1; y_h5n: $ids = $request_data["\x69\144"]; goto KsQdy; vkaHp: $this->db->rollBack(); goto OmR6l; xJ2Ng: eyIXm: goto BbN0x; MdxaP: if (count($error) === 0) { goto QWByE; } goto vkaHp; docyu: $this->_callback("\x63\141\x6c\x6c\x62\141\143\x6b\x44\x65\154\145\164\x65\x42\145\x66\157\162\x65", array(&$request_data)); goto UGFIE; BbN0x: } }
