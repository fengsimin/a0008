<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto dIJMx; GpAsp: if (!empty($_FILES["\146\x69\x6c\x65"])) { goto GXVjW; } goto Uxph_; cBIoN: return $this->success('', array("\160\x61\x74\150" => $file_save_path, "\x69\155\141\x67\145" => $handle->file_dst_name, "\163\x69\x7a\145" => $handle->file_src_size, "\167\x69\144\164\x68" => $handle->image_src_x, "\x68\x65\151\147\150\x74" => $handle->image_src_y, "\x74\171\160\x65" => $handle->image_dst_type, "\145\170\164" => $handle->file_dst_name_ext)); goto TiFU7; a8ai7: $handle->jpeg_quality = $quality; goto Lr2Tt; Lr2Tt: QA1DA: goto T1Wdm; p3J0W: $image_x = explode("\54", $_POST["\151\155\x61\147\x65\137\x78"]); goto y_B7z; UFIKF: goto zL5Hc; goto aC9IC; TiFU7: zL5Hc: goto Cu0X4; WuXFE: $file_save_path = ''; goto UTM05; D58bu: $handle->file_new_name_body = $file_new_name_body; goto SQWb0; iEOE7: if ($handle->processed) { goto T8D1c; } goto KN8M2; EBz6X: kiGoA: goto tHxjM; TIwRc: $handle = new Upload($_FILES["\x66\151\154\145"]); goto zyXfI; qVgZY: LHuv0: goto faA42; GU6wM: goto kiGoA; goto sYbe0; aC9IC: T8D1c: goto tsddz; sYbe0: mrEM5: goto ILgv0; y_B7z: $image_y = explode("\54", $_POST["\151\155\141\147\145\x5f\x79"]); goto e9CNm; sWOUF: GXVjW: goto Hpmm3; wxP6h: $jpeg_quality = explode("\54", $_POST["\152\160\145\147\x5f\161\x75\x61\x6c\151\x74\171"]); goto v2AUm; T1Wdm: if (!$image_convert) { goto LHuv0; } goto Mz5ZF; Uxph_: return $this->error("\346\227\xa0\346\x95\210\xe7\x9a\204\346\x96\x87\344\273\266\xe4\xbf\xa1\xe6\201\257\357\274\x81"); goto ENtJ8; zyXfI: if (!$handle->uploaded) { goto PHP53; } goto kJT8O; Hpmm3: ifeiwu\Loader::import("\x65\x78\x74\x65\x6e\144\x2f\x55\160\x6c\157\x61\x64"); goto TIwRc; KN8M2: return $this->error($handle->log); goto UFIKF; u_Mts: $file_save_path = $_POST["\x66\151\x6c\145\x5f\x73\x61\166\x65\137\x70\141\164\x68"]; goto tZ3gw; tHxjM: PHP53: goto iEOE7; c1Pqx: $quality = end($jpeg_quality); goto FWli3; tZ3gw: $image_convert = $_POST["\151\x6d\141\x67\145\x5f\143\157\156\166\145\x72\164"]; goto wxP6h; kJT8O: $upload_root = "\x2e\x2e\57"; goto UHUxV; EOKXz: $_FILES["\146\151\x6c\x65"]["\x73\x69\172\145"] = $_POST["\146\x69\154\x65\137\x73\151\172\145"]; goto SPnO5; Cu0X4: FGBOO: goto MkWqF; FWli3: if (!$quality) { goto QA1DA; } goto a8ai7; vk12d: $handle->Process($upload_root . "\x2f" . $file_save_path); goto GU6wM; tFWjQ: $handle->file_overwrite = $file_overwrite ? true : false; goto vk12d; FaQLL: sdfLB: goto EBz6X; GzGDg: $file_overwrite = $_POST["\146\151\154\145\137\157\x76\x65\x72\167\162\151\x74\145"]; goto adOJ0; adOJ0: $image_resize = $_POST["\x69\155\x61\147\145\x5f\x72\x65\163\151\x7a\145"]; goto u_Mts; oAf0h: $_FILES["\x66\151\x6c\x65"]["\x74\171\160\145"] = $_POST["\146\x69\x6c\x65\x5f\x74\171\x70\145"]; goto EOKXz; tsddz: if (!($file_save_path == "\57")) { goto QLmV2; } goto WuXFE; ILgv0: $file_name_body_pre = explode("\x2c", $_POST["\146\151\154\x65\137\156\141\155\145\x5f\142\157\144\171\x5f\160\162\145"]); goto p3J0W; SQWb0: Wh7Sw: goto tFWjQ; e9CNm: foreach ($file_name_body_pre as $key => $prefix) { goto qoyUc; k6Wai: rGop2: goto q5CJQ; u4VL5: $handle->image_y = $height; goto Z86YH; CtYt8: $handle->file_new_name_body = $file_new_name_body; goto fgC3d; reURe: if ($height && $handle->image_src_y > $height) { goto AgTUr; } goto ankrI; Q1wJl: goto TCqiw; goto MxlXY; qoyUc: $width = $image_x[$key]; goto ARsgl; fgC3d: n9FWg: goto EkY8R; DB4qh: if (!$prefix) { goto O922G; } goto xBFD8; pjy5z: $quality = $jpeg_quality[$key]; goto DB4qh; oT1IF: AgTUr: goto u4VL5; xBFD8: $handle->image_resize = $image_resize ? true : false; goto JJqyT; dKTDa: $handle->image_x = $handle->image_src_x; goto Q1wJl; iH5YW: $handle->Process($upload_root . "\57" . $file_save_path); goto k6Wai; fzNMj: if (!$file_new_name_body) { goto n9FWg; } goto CtYt8; EkY8R: $handle->file_overwrite = $file_overwrite ? true : false; goto iH5YW; Bnujo: YqTGm: goto P4Q5m; ARsgl: $height = $image_y[$key]; goto pjy5z; Lrb0y: O922G: goto oztGQ; dKGnH: goto kQY7c; goto oT1IF; JJqyT: $handle->file_name_body_pre = $prefix; goto Lrb0y; jkwVf: TCqiw: goto reURe; Z86YH: kQY7c: goto fzNMj; ankrI: $handle->image_ratio_y = true; goto dKGnH; jEyjh: $handle->jpeg_quality = $quality; goto C3HPO; oztGQ: if (!$quality) { goto cPIlM; } goto jEyjh; MxlXY: Oxe50: goto D_3K0; yiVcv: $handle->image_convert = $image_convert; goto Bnujo; wHzg2: if (!$image_convert) { goto YqTGm; } goto yiVcv; C3HPO: cPIlM: goto wHzg2; D_3K0: $handle->image_x = $width; goto jkwVf; P4Q5m: if ($width && $handle->image_src_x > $width) { goto Oxe50; } goto dKTDa; q5CJQ: } goto FaQLL; UTM05: QLmV2: goto cBIoN; UHUxV: $file_new_name_body = $_POST["\x66\151\154\145\x5f\156\x65\x77\137\x6e\x61\x6d\x65\x5f\142\157\x64\x79"]; goto GzGDg; faA42: if (!$file_new_name_body) { goto Wh7Sw; } goto D58bu; v2AUm: if ($image_resize == 1) { goto mrEM5; } goto c1Pqx; dIJMx: $_FILES["\146\151\154\145"]["\156\141\x6d\145"] = $_POST["\x66\x69\154\145\x5f\x6e\x61\155\x65"]; goto oAf0h; SPnO5: $_FILES["\x66\151\x6c\145"]["\x65\x72\x72\157\x72"] = $_POST["\146\151\154\x65\x5f\x65\x72\x72\157\162"]; goto GpAsp; ENtJ8: goto FGBOO; goto sWOUF; Mz5ZF: $handle->image_convert = $image_convert; goto qVgZY; MkWqF: } protected function postFile($request_data) { goto WgSZ3; LD3Tj: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\x72\x65\x73\165\x6d\141\142\154\145\103\x68\x75\x6e\153\123\x69\172\145"], $_POST["\x72\x65\x73\165\x6d\x61\142\x6c\x65\x54\157\164\x61\154\123\151\172\x65"]); goto Ex3Rg; LN2PH: if (!($file["\x65\162\162\x6f\x72"] != 0)) { goto Kx3NC; } goto QrNZF; RF2Bg: mkdir($temp_dir, 511, true); goto uuFqT; paJrM: $file = $_FILES["\x66\151\154\x65"]; goto LN2PH; WgSZ3: $save_path = "\56\x2e\x2f" . $this->_UTF82GBK($_POST["\x73\x61\x76\x65\x5f\x70\x61\x74\x68"]); goto EIQJB; Wlg43: if (!move_uploaded_file($file["\x74\155\x70\137\x6e\x61\155\x65"], $dest_file)) { goto EKER0; } goto LD3Tj; B6YpT: if (is_dir($temp_dir)) { goto baKoR; } goto RF2Bg; W5zHg: rxFEf: goto X8CGK; Ex3Rg: goto rxFEf; goto yyLYd; sDSY2: $resumableChunkNumber = $_POST["\162\x65\x73\x75\155\141\x62\154\x65\x43\150\165\x6e\x6b\x4e\165\155\x62\x65\x72"]; goto oiU_3; QMdNd: $this->_debug("\105\162\162\x6f\x72\40\163\141\166\151\x6e\x67\x20\50\155\x6f\166\145\137\x75\160\x6c\x6f\x61\144\145\144\x5f\146\x69\154\x65\51\x20\x63\150\165\x6e\153\x20" . $resumableChunkNumber . "\x20\x66\x6f\x72\x20\x66\151\154\145\40" . $resumableFilename); goto W5zHg; oiU_3: $resumableIdentifier = $_POST["\x72\x65\163\165\x6d\141\x62\154\x65\x49\144\x65\156\x74\x69\146\x69\145\162"]; goto QiqLP; HpnBP: $dest_file = $temp_dir . "\57" . $resumableFilename . "\56\160\141\x72\x74" . $resumableChunkNumber; goto B6YpT; QrNZF: $this->_debug("\145\x72\162\157\162\40" . $file["\x65\x72\162\157\162"] . "\40\x69\156\40\146\151\154\145\x20" . $resumableFilename); goto a3Iwk; wsDVW: $_FILES["\146\151\x6c\x65"]["\163\151\172\x65"] = $_POST["\146\x69\x6c\x65\137\163\151\x7a\145"]; goto ADTWn; uuFqT: baKoR: goto Wlg43; lbe0f: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto HpnBP; yyLYd: EKER0: goto QMdNd; bSR7T: $_FILES["\x66\151\x6c\x65"]["\x74\x79\160\x65"] = $_POST["\x66\x69\x6c\145\137\x74\x79\x70\x65"]; goto wsDVW; EIQJB: $resumableFilename = $this->_UTF82GBK($_POST["\x72\145\163\x75\x6d\x61\x62\x6c\145\x46\x69\x6c\145\156\141\155\x65"]); goto sDSY2; QiqLP: $_FILES["\x66\151\154\x65"]["\x6e\141\x6d\x65"] = $_POST["\146\x69\x6c\145\137\x6e\141\x6d\x65"]; goto bSR7T; ADTWn: $_FILES["\x66\151\x6c\145"]["\x65\x72\162\x6f\x72"] = $_POST["\x66\151\x6c\145\x5f\145\x72\162\x6f\162"]; goto paJrM; a3Iwk: Kx3NC: goto lbe0f; X8CGK: } protected function getFile() { goto Cz_dW; OGGz6: $chunk_file = $temp_dir . "\x2f" . $resumableFilename . "\56\160\141\162\164" . $resumableChunkNumber; goto eil3v; sPFoh: return 404; goto dsZuQ; Jfrel: return 202; goto v8PCq; eil3v: if (file_exists($chunk_file)) { goto bW1jo; } goto sPFoh; Cz_dW: $save_path = "\x2e\56\57" . $this->_UTF82GBK($_GET["\x73\x61\x76\x65\137\x70\141\x74\150"]); goto jc4rS; SCR8b: bW1jo: goto Jfrel; dsZuQ: goto eNiYW; goto SCR8b; v8PCq: eNiYW: goto PKI9k; oupCt: $resumableChunkNumber = $_GET["\x72\x65\x73\x75\155\141\x62\x6c\145\x43\x68\x75\156\153\116\x75\155\x62\145\162"]; goto gAweN; gAweN: $resumableIdentifier = $_GET["\162\x65\163\x75\155\141\x62\154\x65\111\144\x65\x6e\164\151\x66\x69\145\162"]; goto TafeP; jc4rS: $resumableFilename = $this->_UTF82GBK($_GET["\x72\x65\163\165\x6d\x61\x62\154\145\106\x69\154\145\156\x61\x6d\145"]); goto oupCt; TafeP: $temp_dir = $save_path . "\57" . $resumableIdentifier; goto OGGz6; PKI9k: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto IPkSP; q2h4C: fclose($fp); goto osVkO; AYzge: osSvF: goto WuUQh; xjzjx: if (rename($temp_dir, $temp_dir . "\x5f\125\116\125\x53\x45\x44")) { goto KpOvN; } goto UNTbh; jb6Kt: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto mtFyu; } goto MAkhx; osVkO: cfq8I: goto xjzjx; UdnV0: if (!($i <= $total_files)) { goto tBRGj; } goto zN7Xa; omtIk: tBRGj: goto q2h4C; EFKGJ: foreach (scandir($temp_dir) as $file) { goto MkBFo; efmM3: $total_files++; goto C_W2x; jIiup: anTUL: goto OeLUv; MkBFo: if (!(stripos($file, $fileName) !== false)) { goto aEv6e; } goto efmM3; C_W2x: aEv6e: goto jIiup; OeLUv: } goto DiisD; h7N3g: goto D_7uz; goto omtIk; UNTbh: $this->_rrmdir($temp_dir); goto nw1in; VJHrl: mtFyu: goto BuMwk; UpoKd: KpOvN: goto FKFkF; FKFkF: $this->_rrmdir($temp_dir . "\x5f\125\116\x55\x53\105\x44"); goto fX5le; fX5le: gbYRO: goto VJHrl; IPkSP: $total_files = 0; goto EFKGJ; uvJmk: return false; goto l0YsN; MAkhx: if (($fp = fopen($save_path . "\x2f" . $fileName, "\x77")) !== false) { goto BKteQ; } goto pLlcB; nw1in: goto gbYRO; goto UpoKd; pmvx8: $i = 1; goto qroCH; l0YsN: goto cfq8I; goto HJSVV; HJSVV: BKteQ: goto pmvx8; zN7Xa: fwrite($fp, file_get_contents($temp_dir . "\x2f" . $fileName . "\56\x70\141\162\164" . $i)); goto AYzge; DiisD: C0Q7v: goto jb6Kt; WuUQh: $i++; goto h7N3g; pLlcB: $this->_debug("\143\x61\x6e\x6e\x6f\164\40\x63\162\x65\141\x74\x65\40\x74\150\x65\40\144\145\163\164\x69\156\x61\164\x69\x6f\x6e\40\146\x69\154\x65"); goto uvJmk; qroCH: D_7uz: goto UdnV0; BuMwk: } private function _rrmdir($dir) { goto POSib; IJvRI: rmdir($dir); goto soGVN; POSib: if (!is_dir($dir)) { goto PO9Ix; } goto I3iuc; UlG7k: reset($objects); goto IJvRI; w0kFJ: Oyqcw: goto UlG7k; ZDHoa: foreach ($objects as $object) { goto CwSwQ; ggNBg: CbsUE: goto Na7_W; HAxl7: if (filetype($dir . "\x2f" . $object) == "\x64\151\x72") { goto fhdyM; } goto uJ6J7; x6JzJ: goto CbsUE; goto QQNgN; TOpvZ: $this->_rrmdir($dir . "\57" . $object); goto ggNBg; uJ6J7: unlink($dir . "\57" . $object); goto x6JzJ; NAcvZ: ZQQaS: goto Awhkp; Na7_W: QuaoR: goto NAcvZ; QQNgN: fhdyM: goto TOpvZ; CwSwQ: if (!($object != "\x2e" && $object != "\x2e\56")) { goto QuaoR; } goto HAxl7; Awhkp: } goto w0kFJ; soGVN: PO9Ix: goto uQAVL; I3iuc: $objects = scandir($dir); goto ZDHoa; uQAVL: } }
